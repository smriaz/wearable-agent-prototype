name: Ping Streamlit App

on:
  schedule:
    - cron: "*/30 * * * *"
  workflow_dispatch:

jobs:
  ping:
    runs-on: ubuntu-latest
    steps:
      - name: Ping Streamlit (status check)
        run: |
          URL="https://wearable-agent-prototype.streamlit.app/"
          echo "Pinging: $URL"

          code=$(curl -A "Mozilla/5.0" -H "Accept: text/html" -sS -L -o /dev/null -w "%{http_code}" --max-time 60 "$URL" || echo "000")
          echo "HTTP status: $code"

          if [ "$code" = "200" ] || [ "$code" = "302" ] || [ "$code" = "303" ]; then
            echo "Ping OK"
            exit 0
          else
            echo "Ping failed (HTTP $code)"
            exit 1
          fi
